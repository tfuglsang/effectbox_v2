# **3.8 Packing and unpacking instructions**

*[Table 31](#page-0-0)* shows the instructions that operate on packing and unpacking data:

**Table 31. Packing and unpacking instructions** 

<span id="page-0-0"></span>

| Mnemonic | Brief description                     | See                         |
|----------|---------------------------------------|-----------------------------|
| PKH      | Pack Halfword                         | PKHBT and PKHTB on page 135 |
| SXTAB    | Extend 8 bits to 32 and add           | SXTA and UXTA on page 137   |
| SXTAB16  | Dual extend 8 bits to 16 and add      | SXTA and UXTA on page 137   |
| SXTAH    | Extend 16 bits to 32 and add          | SXTA and UXTA on page 137   |
| SXTB     | Sign extend a byte                    | SXT and UXT on page 136     |
| SXTB16   | Dual extend 8 bits to 16 and add      | SXT and UXT on page 136     |
| SXTH     | Sign extend a halfword                | SXT and UXT on page 136     |
| UXTAB    | Extend 8 bits to 32 and add           | SXTA and UXTA on page 137   |
| UXTAB16  | Dual extend 8 bits to 16 and add      | SXTA and UXTA on page 137   |
| UXTAH    | Extend 16 bits to 32 and add          | SXTA and UXTA on page 137   |
| UXTB     | Zero extend a byte                    | SXT and UXT on page 136     |
| UXTB16   | Dual zero extend 8 bits to 16 and add | SXT and UXT on page 136     |
| UXTH     | Zero extend a halfword                | SXT and UXT on page 136     |

134/262 PM0214 Rev 10

## <span id="page-1-0"></span>**3.8.1 PKHBT and PKHTB**

Pack Halfword

## **Syntax**

```
op{cond} {Rd}, Rn, Rm {, LSL #imm}
op{cond} {Rd}, Rn, Rm {, ASR #imm}
```

#### Where:

• *op'* is one of:

PKHBT Pack Halfword, bottom and top with shift.

PKHTB Pack Halfword, top and bottom with shift.

- '*cond*' is an optional condition code (see *Conditional execution on page 65*)
- '*Rd*' is the destination register.
- '*Rn*' is the first operand register.
- '*Rm*' is the second operand register holding the value to be optionally shifted.
- '*imm*' is the shift length. The type of shift length depends on the instruction:

For PKHBT: LSL: a left shift with a shift length from 1 to 31, 0 means no shift.

For PKHTB: ASR: an arithmetic shift right with a shift length from 1 to 32,a shift of 32 bits is encoded as 0b00000.

## **Operation**

The PKHBT instruction:

- 1. Writes the value of the bottom halfword of the first operand to the bottom halfword of the destination register.
- 2. If shifted, the shifted value of the second operand is written to the top halfword of the destination register.

The PKHTB instruction:

- 1. Writes the value of the top halfword of the first operand to the top halfword of the destination register.
- 2. If shifted, the shifted value of the second operand is written to the bottom halfword of the destination register.

## **Restrictions**

Rd must not be SP and must not be PC.

## **Condition flags**

This instruction does not change the flags.

## **Examples**

```
PKHBT R3, R4, R5 LSL #0 ; Writes bottom halfword of R4 to bottom halfword
                  ; of R3, writes top halfword of R5, unshifted, to top 
                  ; halfword of R3
PKHTB R4, R0, R2 ASR #1 ; Writes R2 shifted right by 1 bit to bottom half
                  ; word of R4, and writes top halfword of R0 to top 
                  ; halfword of R4.
```

![](_page_1_Picture_30.jpeg)

PM0214 Rev 10 135/262

## <span id="page-2-0"></span>**3.8.2 SXT and UXT**

Sign extend and Zero extend.

## **Syntax**

```
op{cond} {Rd,} Rm {, ROR #n}
op{cond} {Rd}, Rm {, ROR #n}
```

#### Where:

• *op'* is one of:

SXTB Sign extends an 8-bit value to a 32-bit value. SXTH Sign extends a 16-bit value to a 32-bit value. SXTB16 Sign extends two 8-bit values to two 16-bit values. UXTB Zero extends an 8-bit value to a 32-bit value. UXTH Zero extends a 16-bit value to a 32-bit value.

UXTB16 Zero extends two 8-bit values to two 16-bit values.

- '*cond*' is an optional condition code (see *Conditional execution on page 65*)
- '*Rd*' is the destination register.
- '*Rm*' is the register holding the value to extend.
- '*ROR #n*' is one of:

ROR #8 Value from Rm is rotated right 8 bits. ROR #16 Value from Rm is rotated right 16 bits. ROR #24 Value from Rm is rotated right 24 bits. If ROR #n is omitted, no rotation is performed.

## **Operation**

These instructions do the following:

- 1. Rotate the value from Rm right by 0, 8, 16 or 24 bits.
- 2. Extract bits from the resulting value:

SXTB extracts bits[7:0] and sign extends to 32 bits. UXTB extracts bits[7:0] and zero extends to 32 bits. SXTH extracts bits[15:0] and sign extends to 32 bits. UXTH extracts bits[15:0] and zero extends to 32 bits. SXTB16 extracts bits[7:0] and sign extends to 16 bits, and extracts bits [23:16] and sign extends to 16 bits. UXTB16 extracts bits[7:0] and zero extends to 16 bits, and extracts bits [23:16] and zero extends to 16 bits.

## **Restrictions**

Do not use SP and do not use PC.

## **Condition flags**

These instructions do not affect the flags.

136/262 PM0214 Rev 10

![](_page_2_Picture_24.jpeg)

## **Examples**

```
SXTH R4, R6, ROR #16 ; Rotates R6 right by 16 bits, obtains bottom halfword
                     ; of result, sign extends to 32 bits and writes to R4
UXTB R3, R10 ; Extracts lowest byte of value in R10, zero extends, and
                  ; writes to R3.
```

## <span id="page-3-0"></span>**3.8.3 SXTA and UXTA**

Signed and Unsigned Extend and Add

## **Syntax**

```
op{cond} {Rd,} Rn, Rm {, ROR #n}
op{cond} {Rd,} Rn, Rm {, ROR #n}
```

## Where:

• *op'* is one of:

SXTAB Sign extends an 8-bit value to a 32-bit value and add. SXTAH Sign extends a 16-bit value to a 32-bit value and add. SXTAB16 Sign extends two 8-bit values to two 16-bit values and add. UXTAB Zero extends an 8-bit value to a 32-bit value and add. UXTAH Zero extends a 16-bit value to a 32-bit value and add. UXTAB16 Zero extends two 8-bit values to two 16-bit values and add.

- '*cond*' is an optional condition code (see *Conditional execution on page 65*)
- '*Rd*' is the destination register.
- '*Rn*' is the first operand register.
- '*Rm*' is the register holding the value to rotate and extend.
- '*ROR #n*' is one of:

ROR #8 Value from Rm is rotated right 8 bits. ROR #16 Value from Rm is rotated right 16 bits. ROR #24 Value from Rm is rotated right 24 bits. If ROR #n is omitted, no rotation is performed.

## **Operation**

These instructions do the following:

- 1. Rotate the value from Rm right by 0, 8, 16 or 24 bits.
- 2. Extract bits from the resulting value:

SXTAB extracts bits[7:0] from Rm and sign extends to 32 bits. UXTAB extracts bits[7:0] from Rm and zero extends to 32 bits. SXTAH extracts bits[15:0] from Rm and sign extends to 32 bits. UXTAH extracts bits[15:0] from Rm and zero extends to 32 bits. SXTAB16 extracts bits[7:0] from Rm and sign extends to 16 bits, and extracts bits [23:16] from Rm and sign extends to 16 bits. UXTAB16 extracts bits[7:0] from Rm and zero extends to 16 bits, and extracts bits [23:16] from Rm and zero extends to 16 bits.

3. Adds the signed or zero extended value to the word or corresponding halfword of Rn and writes the result in Rd.

PM0214 Rev 10 137/262